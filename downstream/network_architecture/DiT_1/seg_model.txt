Finetuning the UniMISS pretrained MiT on downstream 3D segmentation tasks under nnunet framework 



Please cite the following paper when using this code:

Xie, Yutong and Zhang, Jianpeng and Xia, Yong and Wu, Qi. "UniMiSS: Universal Medical Self-Supervised Learning via Breaking Dimensionality Barrier." ECCV (2022). https://arxiv.org/abs/2112.09356


Code link: https://github.com/YtongXie/UniMiSS-code



Please cite the following paper when using nnUNet:

Isensee, F., Jaeger, P.F., Kohl, S.A.A. et al. "nnU-Net: a self-configuring method for deep learning-based biomedical image segmentation." Nat Methods (2020). https://doi.org/10.1038/s41592-020-01008-z


If you have questions or suggestions, feel free to open an issue at https://github.com/MIC-DKFZ/nnUNet

  + Number of Transformer(Encoder) Params: 28.71(e6)
  + Number of Network Params: 45.08(e6)
before loading weights: 0.000315275392
Patch_embeddings layer1 weights: 0.000119314769
Patch_embeddings layer2 weights: 0.000050523588
Position_embeddings weights: 0.000008503611
model.DecPosEmbed3D0
model.DecPosEmbed3D1
model.DecPosEmbed3D2
model.transformer.pos_embed3D1
model.transformer.pos_embed3D2
model.transformer.pos_embed3D3
model.transformer.pos_embed3D4
model.transformer.patch_embed3D0.conv.weight
model.transformer.patch_embed3D0.norm.weight
model.transformer.patch_embed3D0.norm.bias
model.transformer.patch_embed3D0.norm.running_mean
model.transformer.patch_embed3D0.norm.running_var
model.transformer.patch_embed3D0.norm.num_batches_tracked
model.transformer.patch_embed3D1.proj.conv.weight
model.transformer.patch_embed3D1.proj.norm.weight
model.transformer.patch_embed3D1.proj.norm.bias
model.transformer.patch_embed3D1.proj.norm.running_mean
model.transformer.patch_embed3D1.proj.norm.running_var
model.transformer.patch_embed3D1.proj.norm.num_batches_tracked
model.transformer.patch_embed3D2.proj.conv.weight
model.transformer.patch_embed3D2.proj.norm.weight
model.transformer.patch_embed3D2.proj.norm.bias
model.transformer.patch_embed3D2.proj.norm.running_mean
model.transformer.patch_embed3D2.proj.norm.running_var
model.transformer.patch_embed3D2.proj.norm.num_batches_tracked
model.transformer.patch_embed3D3.proj.conv.weight
model.transformer.patch_embed3D3.proj.norm.weight
model.transformer.patch_embed3D3.proj.norm.bias
model.transformer.patch_embed3D3.proj.norm.running_mean
model.transformer.patch_embed3D3.proj.norm.running_var
model.transformer.patch_embed3D3.proj.norm.num_batches_tracked
model.transformer.patch_embed3D4.proj.conv.weight
model.transformer.patch_embed3D4.proj.norm.weight
model.transformer.patch_embed3D4.proj.norm.bias
model.transformer.patch_embed3D4.proj.norm.running_mean
model.transformer.patch_embed3D4.proj.norm.running_var
model.transformer.patch_embed3D4.proj.norm.num_batches_tracked
model.transformer.block1.0.norm1.weight
model.transformer.block1.0.norm1.bias
model.transformer.block1.0.attn.q.weight
model.transformer.block1.0.attn.q.bias
model.transformer.block1.0.attn.kv.weight
model.transformer.block1.0.attn.kv.bias
model.transformer.block1.0.attn.proj.weight
model.transformer.block1.0.attn.proj.bias
model.transformer.block1.0.attn.sr3D.weight
model.transformer.block1.0.attn.sr3D.bias
model.transformer.block1.0.attn.norm.weight
model.transformer.block1.0.attn.norm.bias
model.transformer.block1.0.norm2.weight
model.transformer.block1.0.norm2.bias
model.transformer.block1.0.mlp.fc1.weight
model.transformer.block1.0.mlp.fc1.bias
model.transformer.block1.0.mlp.fc2.weight
model.transformer.block1.0.mlp.fc2.bias
model.transformer.block1.1.norm1.weight
model.transformer.block1.1.norm1.bias
model.transformer.block1.1.attn.q.weight
model.transformer.block1.1.attn.q.bias
model.transformer.block1.1.attn.kv.weight
model.transformer.block1.1.attn.kv.bias
model.transformer.block1.1.attn.proj.weight
model.transformer.block1.1.attn.proj.bias
model.transformer.block1.1.attn.sr3D.weight
model.transformer.block1.1.attn.sr3D.bias
model.transformer.block1.1.attn.norm.weight
model.transformer.block1.1.attn.norm.bias
model.transformer.block1.1.norm2.weight
model.transformer.block1.1.norm2.bias
model.transformer.block1.1.mlp.fc1.weight
model.transformer.block1.1.mlp.fc1.bias
model.transformer.block1.1.mlp.fc2.weight
model.transformer.block1.1.mlp.fc2.bias
model.transformer.block2.0.norm1.weight
model.transformer.block2.0.norm1.bias
model.transformer.block2.0.attn.q.weight
model.transformer.block2.0.attn.q.bias
model.transformer.block2.0.attn.kv.weight
model.transformer.block2.0.attn.kv.bias
model.transformer.block2.0.attn.proj.weight
model.transformer.block2.0.attn.proj.bias
model.transformer.block2.0.attn.sr3D.weight
model.transformer.block2.0.attn.sr3D.bias
model.transformer.block2.0.attn.norm.weight
model.transformer.block2.0.attn.norm.bias
model.transformer.block2.0.norm2.weight
model.transformer.block2.0.norm2.bias
model.transformer.block2.0.mlp.fc1.weight
model.transformer.block2.0.mlp.fc1.bias
model.transformer.block2.0.mlp.fc2.weight
model.transformer.block2.0.mlp.fc2.bias
model.transformer.block2.1.norm1.weight
model.transformer.block2.1.norm1.bias
model.transformer.block2.1.attn.q.weight
model.transformer.block2.1.attn.q.bias
model.transformer.block2.1.attn.kv.weight
model.transformer.block2.1.attn.kv.bias
model.transformer.block2.1.attn.proj.weight
model.transformer.block2.1.attn.proj.bias
model.transformer.block2.1.attn.sr3D.weight
model.transformer.block2.1.attn.sr3D.bias
model.transformer.block2.1.attn.norm.weight
model.transformer.block2.1.attn.norm.bias
model.transformer.block2.1.norm2.weight
model.transformer.block2.1.norm2.bias
model.transformer.block2.1.mlp.fc1.weight
model.transformer.block2.1.mlp.fc1.bias
model.transformer.block2.1.mlp.fc2.weight
model.transformer.block2.1.mlp.fc2.bias
model.transformer.block2.2.norm1.weight
model.transformer.block2.2.norm1.bias
model.transformer.block2.2.attn.q.weight
model.transformer.block2.2.attn.q.bias
model.transformer.block2.2.attn.kv.weight
model.transformer.block2.2.attn.kv.bias
model.transformer.block2.2.attn.proj.weight
model.transformer.block2.2.attn.proj.bias
model.transformer.block2.2.attn.sr3D.weight
model.transformer.block2.2.attn.sr3D.bias
model.transformer.block2.2.attn.norm.weight
model.transformer.block2.2.attn.norm.bias
model.transformer.block2.2.norm2.weight
model.transformer.block2.2.norm2.bias
model.transformer.block2.2.mlp.fc1.weight
model.transformer.block2.2.mlp.fc1.bias
model.transformer.block2.2.mlp.fc2.weight
model.transformer.block2.2.mlp.fc2.bias
model.transformer.block3.0.norm1.weight
model.transformer.block3.0.norm1.bias
model.transformer.block3.0.attn.q.weight
model.transformer.block3.0.attn.q.bias
model.transformer.block3.0.attn.kv.weight
model.transformer.block3.0.attn.kv.bias
model.transformer.block3.0.attn.proj.weight
model.transformer.block3.0.attn.proj.bias
model.transformer.block3.0.attn.sr3D.weight
model.transformer.block3.0.attn.sr3D.bias
model.transformer.block3.0.attn.norm.weight
model.transformer.block3.0.attn.norm.bias
model.transformer.block3.0.norm2.weight
model.transformer.block3.0.norm2.bias
model.transformer.block3.0.mlp.fc1.weight
model.transformer.block3.0.mlp.fc1.bias
model.transformer.block3.0.mlp.fc2.weight
model.transformer.block3.0.mlp.fc2.bias
model.transformer.block3.1.norm1.weight
model.transformer.block3.1.norm1.bias
model.transformer.block3.1.attn.q.weight
model.transformer.block3.1.attn.q.bias
model.transformer.block3.1.attn.kv.weight
model.transformer.block3.1.attn.kv.bias
model.transformer.block3.1.attn.proj.weight
model.transformer.block3.1.attn.proj.bias
model.transformer.block3.1.attn.sr3D.weight
model.transformer.block3.1.attn.sr3D.bias
model.transformer.block3.1.attn.norm.weight
model.transformer.block3.1.attn.norm.bias
model.transformer.block3.1.norm2.weight
model.transformer.block3.1.norm2.bias
model.transformer.block3.1.mlp.fc1.weight
model.transformer.block3.1.mlp.fc1.bias
model.transformer.block3.1.mlp.fc2.weight
model.transformer.block3.1.mlp.fc2.bias
model.transformer.block3.2.norm1.weight
model.transformer.block3.2.norm1.bias
model.transformer.block3.2.attn.q.weight
model.transformer.block3.2.attn.q.bias
model.transformer.block3.2.attn.kv.weight
model.transformer.block3.2.attn.kv.bias
model.transformer.block3.2.attn.proj.weight
model.transformer.block3.2.attn.proj.bias
model.transformer.block3.2.attn.sr3D.weight
model.transformer.block3.2.attn.sr3D.bias
model.transformer.block3.2.attn.norm.weight
model.transformer.block3.2.attn.norm.bias
model.transformer.block3.2.norm2.weight
model.transformer.block3.2.norm2.bias
model.transformer.block3.2.mlp.fc1.weight
model.transformer.block3.2.mlp.fc1.bias
model.transformer.block3.2.mlp.fc2.weight
model.transformer.block3.2.mlp.fc2.bias
model.transformer.block3.3.norm1.weight
model.transformer.block3.3.norm1.bias
model.transformer.block3.3.attn.q.weight
model.transformer.block3.3.attn.q.bias
model.transformer.block3.3.attn.kv.weight
model.transformer.block3.3.attn.kv.bias
model.transformer.block3.3.attn.proj.weight
model.transformer.block3.3.attn.proj.bias
model.transformer.block3.3.attn.sr3D.weight
model.transformer.block3.3.attn.sr3D.bias
model.transformer.block3.3.attn.norm.weight
model.transformer.block3.3.attn.norm.bias
model.transformer.block3.3.norm2.weight
model.transformer.block3.3.norm2.bias
model.transformer.block3.3.mlp.fc1.weight
model.transformer.block3.3.mlp.fc1.bias
model.transformer.block3.3.mlp.fc2.weight
model.transformer.block3.3.mlp.fc2.bias
model.transformer.block4.0.norm1.weight
model.transformer.block4.0.norm1.bias
model.transformer.block4.0.attn.q.weight
model.transformer.block4.0.attn.q.bias
model.transformer.block4.0.attn.kv.weight
model.transformer.block4.0.attn.kv.bias
model.transformer.block4.0.attn.proj.weight
model.transformer.block4.0.attn.proj.bias
model.transformer.block4.0.norm2.weight
model.transformer.block4.0.norm2.bias
model.transformer.block4.0.mlp.fc1.weight
model.transformer.block4.0.mlp.fc1.bias
model.transformer.block4.0.mlp.fc2.weight
model.transformer.block4.0.mlp.fc2.bias
model.transformer.block4.1.norm1.weight
model.transformer.block4.1.norm1.bias
model.transformer.block4.1.attn.q.weight
model.transformer.block4.1.attn.q.bias
model.transformer.block4.1.attn.kv.weight
model.transformer.block4.1.attn.kv.bias
model.transformer.block4.1.attn.proj.weight
model.transformer.block4.1.attn.proj.bias
model.transformer.block4.1.norm2.weight
model.transformer.block4.1.norm2.bias
model.transformer.block4.1.mlp.fc1.weight
model.transformer.block4.1.mlp.fc1.bias
model.transformer.block4.1.mlp.fc2.weight
model.transformer.block4.1.mlp.fc2.bias
model.transformer.block4.2.norm1.weight
model.transformer.block4.2.norm1.bias
model.transformer.block4.2.attn.q.weight
model.transformer.block4.2.attn.q.bias
model.transformer.block4.2.attn.kv.weight
model.transformer.block4.2.attn.kv.bias
model.transformer.block4.2.attn.proj.weight
model.transformer.block4.2.attn.proj.bias
model.transformer.block4.2.norm2.weight
model.transformer.block4.2.norm2.bias
model.transformer.block4.2.mlp.fc1.weight
model.transformer.block4.2.mlp.fc1.bias
model.transformer.block4.2.mlp.fc2.weight
model.transformer.block4.2.mlp.fc2.bias
model.DecEmbed3D0.proj.weight
model.DecEmbed3D0.proj.bias
model.DecEmbed3D1.proj.weight
model.DecEmbed3D1.proj.bias
model.DecEmbed3D2.proj.weight
model.DecEmbed3D2.proj.bias
model.Decblock0.0.norm1.weight
model.Decblock0.0.norm1.bias
model.Decblock0.0.attn.q.weight
model.Decblock0.0.attn.q.bias
model.Decblock0.0.attn.kv.weight
model.Decblock0.0.attn.kv.bias
model.Decblock0.0.attn.proj.weight
model.Decblock0.0.attn.proj.bias
model.Decblock0.0.attn.sr3D.weight
model.Decblock0.0.attn.sr3D.bias
model.Decblock0.0.attn.norm.weight
model.Decblock0.0.attn.norm.bias
model.Decblock0.0.norm2.weight
model.Decblock0.0.norm2.bias
model.Decblock0.0.mlp.fc1.weight
model.Decblock0.0.mlp.fc1.bias
model.Decblock0.0.mlp.fc2.weight
model.Decblock0.0.mlp.fc2.bias
model.Decblock0.1.norm1.weight
model.Decblock0.1.norm1.bias
model.Decblock0.1.attn.q.weight
model.Decblock0.1.attn.q.bias
model.Decblock0.1.attn.kv.weight
model.Decblock0.1.attn.kv.bias
model.Decblock0.1.attn.proj.weight
model.Decblock0.1.attn.proj.bias
model.Decblock0.1.attn.sr3D.weight
model.Decblock0.1.attn.sr3D.bias
model.Decblock0.1.attn.norm.weight
model.Decblock0.1.attn.norm.bias
model.Decblock0.1.norm2.weight
model.Decblock0.1.norm2.bias
model.Decblock0.1.mlp.fc1.weight
model.Decblock0.1.mlp.fc1.bias
model.Decblock0.1.mlp.fc2.weight
model.Decblock0.1.mlp.fc2.bias
model.Decblock0.2.norm1.weight
model.Decblock0.2.norm1.bias
model.Decblock0.2.attn.q.weight
model.Decblock0.2.attn.q.bias
model.Decblock0.2.attn.kv.weight
model.Decblock0.2.attn.kv.bias
model.Decblock0.2.attn.proj.weight
model.Decblock0.2.attn.proj.bias
model.Decblock0.2.attn.sr3D.weight
model.Decblock0.2.attn.sr3D.bias
model.Decblock0.2.attn.norm.weight
model.Decblock0.2.attn.norm.bias
model.Decblock0.2.norm2.weight
model.Decblock0.2.norm2.bias
model.Decblock0.2.mlp.fc1.weight
model.Decblock0.2.mlp.fc1.bias
model.Decblock0.2.mlp.fc2.weight
model.Decblock0.2.mlp.fc2.bias
model.Decblock1.0.norm1.weight
model.Decblock1.0.norm1.bias
model.Decblock1.0.attn.q.weight
model.Decblock1.0.attn.q.bias
model.Decblock1.0.attn.kv.weight
model.Decblock1.0.attn.kv.bias
model.Decblock1.0.attn.proj.weight
model.Decblock1.0.attn.proj.bias
model.Decblock1.0.attn.sr3D.weight
model.Decblock1.0.attn.sr3D.bias
model.Decblock1.0.attn.norm.weight
model.Decblock1.0.attn.norm.bias
model.Decblock1.0.norm2.weight
model.Decblock1.0.norm2.bias
model.Decblock1.0.mlp.fc1.weight
model.Decblock1.0.mlp.fc1.bias
model.Decblock1.0.mlp.fc2.weight
model.Decblock1.0.mlp.fc2.bias
model.Decblock1.1.norm1.weight
model.Decblock1.1.norm1.bias
model.Decblock1.1.attn.q.weight
model.Decblock1.1.attn.q.bias
model.Decblock1.1.attn.kv.weight
model.Decblock1.1.attn.kv.bias
model.Decblock1.1.attn.proj.weight
model.Decblock1.1.attn.proj.bias
model.Decblock1.1.attn.sr3D.weight
model.Decblock1.1.attn.sr3D.bias
model.Decblock1.1.attn.norm.weight
model.Decblock1.1.attn.norm.bias
model.Decblock1.1.norm2.weight
model.Decblock1.1.norm2.bias
model.Decblock1.1.mlp.fc1.weight
model.Decblock1.1.mlp.fc1.bias
model.Decblock1.1.mlp.fc2.weight
model.Decblock1.1.mlp.fc2.bias
model.Decblock1.2.norm1.weight
model.Decblock1.2.norm1.bias
model.Decblock1.2.attn.q.weight
model.Decblock1.2.attn.q.bias
model.Decblock1.2.attn.kv.weight
model.Decblock1.2.attn.kv.bias
model.Decblock1.2.attn.proj.weight
model.Decblock1.2.attn.proj.bias
model.Decblock1.2.attn.sr3D.weight
model.Decblock1.2.attn.sr3D.bias
model.Decblock1.2.attn.norm.weight
model.Decblock1.2.attn.norm.bias
model.Decblock1.2.norm2.weight
model.Decblock1.2.norm2.bias
model.Decblock1.2.mlp.fc1.weight
model.Decblock1.2.mlp.fc1.bias
model.Decblock1.2.mlp.fc2.weight
model.Decblock1.2.mlp.fc2.bias
model.Decblock1.3.norm1.weight
model.Decblock1.3.norm1.bias
model.Decblock1.3.attn.q.weight
model.Decblock1.3.attn.q.bias
model.Decblock1.3.attn.kv.weight
model.Decblock1.3.attn.kv.bias
model.Decblock1.3.attn.proj.weight
model.Decblock1.3.attn.proj.bias
model.Decblock1.3.attn.sr3D.weight
model.Decblock1.3.attn.sr3D.bias
model.Decblock1.3.attn.norm.weight
model.Decblock1.3.attn.norm.bias
model.Decblock1.3.norm2.weight
model.Decblock1.3.norm2.bias
model.Decblock1.3.mlp.fc1.weight
model.Decblock1.3.mlp.fc1.bias
model.Decblock1.3.mlp.fc2.weight
model.Decblock1.3.mlp.fc2.bias
model.Decblock2.0.norm1.weight
model.Decblock2.0.norm1.bias
model.Decblock2.0.attn.q.weight
model.Decblock2.0.attn.q.bias
model.Decblock2.0.attn.kv.weight
model.Decblock2.0.attn.kv.bias
model.Decblock2.0.attn.proj.weight
model.Decblock2.0.attn.proj.bias
model.Decblock2.0.attn.sr3D.weight
model.Decblock2.0.attn.sr3D.bias
model.Decblock2.0.attn.norm.weight
model.Decblock2.0.attn.norm.bias
model.Decblock2.0.norm2.weight
model.Decblock2.0.norm2.bias
model.Decblock2.0.mlp.fc1.weight
model.Decblock2.0.mlp.fc1.bias
model.Decblock2.0.mlp.fc2.weight
model.Decblock2.0.mlp.fc2.bias
model.Decblock2.1.norm1.weight
model.Decblock2.1.norm1.bias
model.Decblock2.1.attn.q.weight
model.Decblock2.1.attn.q.bias
model.Decblock2.1.attn.kv.weight
model.Decblock2.1.attn.kv.bias
model.Decblock2.1.attn.proj.weight
model.Decblock2.1.attn.proj.bias
model.Decblock2.1.attn.sr3D.weight
model.Decblock2.1.attn.sr3D.bias
model.Decblock2.1.attn.norm.weight
model.Decblock2.1.attn.norm.bias
model.Decblock2.1.norm2.weight
model.Decblock2.1.norm2.bias
model.Decblock2.1.mlp.fc1.weight
model.Decblock2.1.mlp.fc1.bias
model.Decblock2.1.mlp.fc2.weight
model.Decblock2.1.mlp.fc2.bias
model.Decblock2.2.norm1.weight
model.Decblock2.2.norm1.bias
model.Decblock2.2.attn.q.weight
model.Decblock2.2.attn.q.bias
model.Decblock2.2.attn.kv.weight
model.Decblock2.2.attn.kv.bias
model.Decblock2.2.attn.proj.weight
model.Decblock2.2.attn.proj.bias
model.Decblock2.2.attn.sr3D.weight
model.Decblock2.2.attn.sr3D.bias
model.Decblock2.2.attn.norm.weight
model.Decblock2.2.attn.norm.bias
model.Decblock2.2.norm2.weight
model.Decblock2.2.norm2.bias
model.Decblock2.2.mlp.fc1.weight
model.Decblock2.2.mlp.fc1.bias
model.Decblock2.2.mlp.fc2.weight
model.Decblock2.2.mlp.fc2.bias
model.norm.weight
model.norm.bias
model.transposeconv_stage3.weight
model.transposeconv_stage3.bias
model.stage3_de.conv.weight
model.stage3_de.norm.weight
model.stage3_de.norm.bias
model.stage3_de.norm.running_mean
model.stage3_de.norm.running_var
model.stage3_de.norm.num_batches_tracked
model.ds0_cls_conv.weight
model.ds0_cls_conv.bias
model.ds1_cls_conv.weight
model.ds1_cls_conv.bias
model.ds2_cls_conv.weight
model.ds2_cls_conv.bias
model.ds3_cls_conv.weight
model.ds3_cls_conv.bias
model.cls_conv.weight
model.cls_conv.bias
